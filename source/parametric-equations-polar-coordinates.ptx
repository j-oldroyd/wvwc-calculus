<?xml version="1.0" encoding="UTF-8" ?>

<!--********************************************************************

*********************************************************************-->
<!-- This file was originally part of the book     -->
<!-- (as copied on 2015/07/12)                     -->
<!--                                               -->
<!--   Abstract Algebra: Theory and Applications   -->
<!--                                               -->
<!-- Copyright (C) 1997-2014  Thomas W. Judson     -->

<chapter xml:id="parametric-equations-polar-coordinates" xmlns:xi="http://www.w3.org/2001/XInclude">
  <title>Parametric Equations and Polar Coordinates</title>
  <introduction>
    <p>
      Equations of the form <m>y=f(x)</m> are well-suited for describing one-dimensional relationships between quantities but lose their effectiveness in higher dimensions.
      However, higher dimensional problems (such as describing motion through space) require more complicated models.
      We will therefore focus on extending the calculus concepts we've already developed for one-dimensional problems to two- and three-dimensional models.
    </p>
  </introduction>
  <section xml:id="section-parametric-equations">
    <title>Parametric Equations</title>
    <p>
      If a particle is moving in two dimensions (i.e., the <m>xy</m>-plane), then it makes sense to write the <m>x</m>- and <m>y</m>-coordinates of its <term>trajectory</term> in terms of time <m>t</m>:
      <md>
        <mrow>x \amp = x(t) </mrow>
        <mrow>y \amp = y(t) </mrow>
      </md>.
      We can use <term>parametric equations</term> to describe the resulting <term>parametric curves</term>.
      For example, the parametric equations
      <md>
        <mrow>x \amp = 2t^{2}-1 </mrow>
        <mrow>y \amp = t+1 </mrow>
        <mrow>-2 \amp \leq t\leq 2 </mrow>
      </md>
      produce the following parametric curve in the <m>xy</m>-plane.
    </p>
    <figure xml:id="figure-parametric-parabola">
      <image xml:id="image-parametric-parabola" width="50%">
        <latex-image xml:id="latex-image-parametric-parabola">
          \begin{tikzpicture}
            \begin{axis}[
            myaxis,
            scale only axis,
            scale=1.5,
            xmin=-2, xmax=8,
            ymin=-2, ymax=4,
            legend style={at={(0.5,-0.2)}, anchor={north},legend columns=-1},
            clip=false,
            ]
            \addplot+[myplot,variable=\t,domain=-2:2,-] ({2*t^2-1}, {t+1});
            \addlegendentry{$x = 2t^2-1, y=t+1$};

            \def\NORM{sqrt((2*t^2-1)^2 + (t+1)^2)}
            \addplot[thick, red,-stealth,samples=5,variable=\t, domain=-2:2, quiver={
                u=4*t/\NORM, v=1/\NORM,
                scale arrows=0.01,
            }]
            ({2*t^2-1}, {t+1});

            \coordinate (A) at (axis cs:7,-1);
            \coordinate (B) at (axis cs:1,0);
            \coordinate (C) at (axis cs:-1,1);
            \coordinate (D) at (axis cs:1,2);
            \coordinate (E) at (axis cs:7,3);


            \node[below] at (A) {$t=-2$};
            \node[above right, xshift=-2.5pt] at (B) {$t=-1$};
            \node[left] at (C) {$t=0$};
            \node[above right, yshift=2.5pt, xshift=-3pt] at (D) {$t=1$};
            \node[above] at (E) {$t=2$};
            \end{axis}
          \end{tikzpicture}
        </latex-image>
      </image>
      <caption>The graph of <m>x = 2t^2-1, y=t+1</m> for <m>-2\leq t\leq 2</m>.</caption>
    </figure>
    <p>
      Note that the parametric curve above has a <em>starting point</em> and an <em>ending point</em>, determined by the interval of values for <m>t</m>.
      When plotting parametric curves, we'll often specify a corresponding interval of values for <m>t</m>.
      This curve can also be plotted relatively painlessly with SymPy, as below:
    </p>
    <sage>
      <input>
        import sympy as sp
        from sympy.plotting import plot_parametric

        t = sp.symbols('t')
        plot_parametric(2 * t**2 - 1, t + 1, (t, -2, 2))
      </input>
    </sage>
    <p>
      A set of parametric equations (along with a corresponding interval of values for <m>t</m>) can be viewed as defining a single function <m>f(t)</m> that assigns points in the <m>xy</m>-plane to real numbers <m>t</m>.
      We'll introduce some notation that will come in handy later: let <m>\mathbb{R}</m> denote the set of real numbers (also known as <term>scalars</term>), and let <m>\mathbb{R}^{2}</m> denote the <m>xy</m>-plane.
      Then a set of parametric equations describes a function from <m>\mathbb{R}</m> (specifically, an interval in <m>\mathbb{R}</m>) to <m>\mathbb{R}^{2}</m>.
      We'll see more of this in the following chapters.
    </p>
    <p>
      Plotting points and plugging them into parametric equations can be tedious.
      Another way to describe a parametric curve is to eliminate parameters.
    </p>
    <example xml:id="example-eliminating-parameters">
      <title>Eliminating parameters</title>
      <statement>
        <p>
          Rewrite the parametric equations
        </p>
        <md>
          <mrow>x \amp = 2t^{2}-1 </mrow>
          <mrow>y \amp = t+1 </mrow>
        </md>
        as a single <em>Cartesian</em> equation, i.e., eliminate the parameter <m>t</m>.
      </statement>
      <solution>
        <p>
          First, solve for <m>t</m> in the second equation to get <m>t = y-1</m>.
          If we plug this into the first equation, we get an equation in <m>x</m> and <m>y</m> alone:
        </p>
        <me>x = 2(y-1)^{2}-1.</me>
        <p>
          We can see from this equation that the original parametric equations should trace out a rightward opening parabola.
          Note however that this equation tells us nothing about which portion of the parabola is traced out.
        </p>
      </solution>
    </example>
    <example xml:id="example-parameterizing-a-line-segment">
      <title>Parameterizing a Line Segment</title>
      <statement>
        <p>
          Give a set of parametric equations and a corresponding interval that trace out the line segment starting at <m>(1,-3)</m> and ending at <m>(-2,4)</m>.
        </p>
      </statement>
      <solution>
        <p>
          First, we'll try to figure out what our equations should look like.
          We know that <m>x</m> starts at <m>1</m> and <m>y</m> starts at <m>-3</m> on this segment, so a reasonable guess is
          <md>
            <mrow>x \amp = 1 + at </mrow>
            <mrow>y \amp = -3 + bt </mrow>
          </md>
          for some unknown constants <m>a</m> and <m>b</m>.
          To find <m>a</m> and <m>b</m>, we'll specify the interval of values we want <m>t</m> to range over.
          To make things easier, let's fix <m>t</m> between <m>0</m> and <m>1</m>.
          Then at <m>t = 1</m> we need to have
          <md>
            <mrow>x \amp = 1 + a = -2 </mrow>
            <mrow>y \amp = -3 + b = 4 </mrow>
          </md>
          which gives <m>a = -3</m> and <m>b = 7</m>.
          Therefore the line segment is parameterized by
          <md>
            <mrow>x \amp = 1 - 3t </mrow>
            <mrow>y \amp = -3 + 7t </mrow>
            <mrow>0 \amp \leq t\leq 1 </mrow>
          </md>.
        </p>
        <p>
          We can also rewrite these equations in terms of the starting and ending values of <m>x</m> and <m>y</m>.
          In particular, we have
          <md>
            <mrow>x \amp = 1(1 - t) + (-2)t </mrow>
            <mrow>y \amp = -3(1 - t) + 4t </mrow>
            <mrow>0 \amp \leq t\leq 1 </mrow>
          </md>.
          To see why this works, note that the second term in each equation vanishes at <m>t = 0</m>, leaving the starting value for each coordinate.
          Likewise, the first term in each equation vanishes at <m>t = 1</m>, leaving the terminal value for each coordinate.
          Expanding the equations gives the previous result.
          Note that this method only works if you select <m>[0,1]</m> as your interval of values for <m>t</m>.
        </p>
      </solution>
    </example>
    <p>
      Parametric equations are especially useful for tracing movement along a curve that is not the graph of a function, like a circle.
      In particular, a circle of radius <m>r</m> centered at <m>(h,k)</m> is traced out by the parametric equations
      <md>
        <mrow>x \amp = h + r\cos t </mrow>
        <mrow>y \amp = k + r\sin t </mrow>
      </md>
      over the interval <m>0\leq t\leq 2\pi</m>.
    </p>
    <example xml:id="example-parametric-equations-for-motion-on-a-circle">
      <title>Parametric Equations for Motion on a Circle</title>
      <statement>
        <p>
          Find parametric equations and a corresponding interval of values for <m>t</m> that describe a particle moving along a circle of radius <m>3</m> centered at <m>(3,-2)</m> and starting at <m>(6,-2)</m> moving <em>clockwise</em> three times around the circle.
        </p>
      </statement>
      <solution>
        <p>
          This problem has a lot to unpack, but we know the basic form of our equations will be
          <me>x = 3 + 3\cos t\qq{and} y = -2 + 3\sin t</me>.
          Since we want to start at <m>(6,-2)</m>, we can let <m>t = 0</m> be our starting value.
          And since we want to move around the circle <m>3</m> times, we'll let <m>t</m> vary from <m>0</m> to <m>6\pi</m>.
          Finally, to get clockwise motion we need to replace <m>t</m> with <m>-t</m>, getting
          <md>
            <mrow>x \amp = 3 + 3\cos t </mrow>
            <mrow>y \amp = -2 - 3\sin t </mrow>
          </md>
          for <m>0\leq t\leq 6\pi</m>.
        </p>
      </solution>
    </example>
    <example xml:id="example-parametric-equations-for-an-ellipse">
      <title>Parametric Equations for an Ellipse</title>
      <statement>
        <p>
          Find parametric equations for the ellipse
          <me>\frac{x^{2}}{a^{2}} + \frac{y^{2}}{b^{2}} = 1</me>.
        </p>
      </statement>
      <solution>
        <p>
          These equations will look much like the parametric equations for a circle:
          <md>
            <mrow>x \amp = a\cos t </mrow>
            <mrow>y \amp = b\sin t </mrow>
          </md>
          for <m>0\leq t\leq 2\pi</m>.
        </p>
      </solution>
    </example>
  </section>

  <section xml:id="section-calculus-and-parametric-curves">
    <title>Calculus and Parametric Curves</title>
    <subsection xml:id="subsection-tangent-lines-parametric-curves">
      <title>Tangent Lines to Parametric Curves</title>
      <p>
        We have an idea of how to represent curves in the <m>xy</m>-plane using parametric equations.
        What we'd like to do now is to figure out how to do calculus with parametric equations.
        To start, we'll find the slope of a parametric curve at some value <m>t</m>.
        Suppose that
        <md>
          <mrow>x \amp = f(t) </mrow>
          <mrow>y \amp = g(t) </mrow>
        </md>.
        Then we can find the slope <m>\dv{y}{x}</m> using the chain rule:
        <me>\dv{y}{t} = \dv{y}{x}\dv{x}{t}</me>
        and so <m>\dv{y}{x} = \dv{y}{t}/\dv{x}{t} = g'(t)/f'(t)</m>, assuming that <m>g'(t)\neq0</m>.
      </p>
      <example xml:id="example-cusps-on-a-cycloid">
        <title>Cusps on a Cycloid</title>
        <statement>
          <p>
            The parametric equations
            <md>
              <mrow>x \amp = t - \sin t </mrow>
              <mrow>y \amp = 1 - \cos t </mrow>
            </md>
            trace out a <term>cycloid</term>, also known as the <term>brachistochrone</term> or <term>curve of fastest descent</term>.
            Find the values of <m>t</m> for which this curve has a cusp.
          </p>
        </statement>
        <solution>
          <p>
            First, note that a curve cannot be differentiable at a cusp.
            So we can try to find the cusps by looking at where <m>\dv{y}{x}</m> fails to exist.
            This occurs precisely at <m>t = 2k\pi</m> for any integer <m>k</m>.
            Hence the cycloid should have a cusp at these values of <m>t</m>.
          </p>
        </solution>
      </example>
    </subsection>

    <subsection xml:id="subsection-area-under-parametric-curves">
      <title>Area Under Parametric Curves</title>
      <p>
        We can also find areas by using <m>u</m>-substitution and the Fundamental Theorem of Calculus.
        If <m>y = F(x)</m>, then the area under the curve <m>y=F(x)</m> from <m>x=a</m> to <m>x=b</m> is given by <m>\int_{a}^{b} F(x)\,dx</m>.
        If we instead have parametric equations
        <md>
          <mrow>x \amp = f(t) </mrow>
          <mrow>y \amp = g(t), </mrow>
        </md>
        then <m>y = F(x) = F(f(t)) = g(t)</m> and <m>dx = f'(t)\,dt</m>. If the curve goes from <m>x=a</m> to <m>x=b</m> exactly once as <m>t</m> goes from <m>\alpha</m> to <m>\beta</m>, then the area under the curve is given by
        <me>\int_{\alpha}^{\beta}g(t)f'(t)\,dt.</me>
      </p>
      <example xml:id="example-area-of-a-circle">
        <title>Area of a Circle</title>
        <p>Suppose we want to find the area of a circle of radius <m>r</m>. We can do so by parameterizing such a circle with</p>
        <md>
          <mrow>x \amp = r\cos t </mrow>
          <mrow>y \amp = r\sin t </mrow>
          <mrow>0 \amp \leq t\leq 2\pi. </mrow>
        </md>
        <p>
          Then the area of the circle is given by
          <md>
            <mrow>2\int_{\pi}^{0} -r^{2}\sin^{2}t\,dt \amp= -2r^{2}\int_{\pi}^{0}\frac{1-\cos2t}{2}\,dt</mrow>
            <mrow> \amp = -r^{2}\left[t-\frac{1}{2}\sin2t\right]_{\pi}^{0} </mrow>
            <mrow> \amp = \pi r^{2}.</mrow>
          </md>
          One thing to watch out for in the previous calculation is that the limits went from <m>\pi</m> to <m>0</m>. This was because of the particular parameterization we chose.
        </p>
      </example>
    </subsection>

    <subsection xml:id="subsection-arc-length-parametric-curves">
      <title>Arc Length of Parametric Curves</title>
      <p>Now we move on to finding lengths of parametric curves. We won't derive the formula here, but it essentially follows from the Pythagorean theorem. We'll see a motivation of the formula later using vector calculus. But for now, suppose we have</p>
      <md>
        <mrow>x \amp = f(t) </mrow>
        <mrow>y \amp = g(t). </mrow>
      </md>
      <p>Then the length of the associated parametric curve from <m>t=\alpha</m> to <m>t=\beta</m> is given by </p>
      <me>\int_{\alpha}^{\beta} \sqrt{f'(t)^{2}+g'(t)^{2}}\,dt = \int_{\alpha}^{\beta}\sqrt{\left(\dv{x}{t}\right)^{2} + \left(\dv{y}{t}\right)^{2}}\,dt.</me>

      <example xml:id="example-arc-length-of-a-parametric-curve">
        <title>Arc Length of a Parametric Curve</title>
        <p>Let <m>x = e^{t}+e^{-t}</m> and <m>y = 5-2t</m> for <m>0\leq t\leq 3.</m> Then the length of this curve is given by</p>
        <md>
          <mrow>\int_{0}^{3}\sqrt{(e^{t}-e^{-t})^{2} + 4}\,dt \amp = \int_{0}^{3}\sqrt{e^{2t}-2 + e^{-2t} + 4}\,dt </mrow>
          <mrow> \amp = \int_{0}^{3}\sqrt{e^{2t} + 2 + e^{-2t}}\,dt </mrow>
          <mrow> \amp = \int_{0}^{3}\sqrt{(e^{t}+e^{-t})^{2}}\,dt </mrow>
          <mrow> \amp = \int_{0}^{3}(e^{t}+e^{-t})\,dt</mrow>
          <mrow> \amp = e^{3}-e^{-3}.</mrow>
        </md>
      </example>
      <p>SUGGESTED PROBLEMS: 1, 3, 13, 37</p>
    </subsection>
  </section>
  <section xml:id="section-polar-coordinates">
    <title>Polar Coordinates</title>
    <subsection xml:id="subsection-introducing-polar-coordinates">
      <title>Introducing Polar Coordinates</title>
      <p>
        We typically use <term>Cartesian</term> or <term>rectangular</term> coordinates to plot points. 
        However, this can lead to issues if we have a graph that isn't rectangular. 
        For example, the circle has a simple geometric description based on its center and radius, but in Cartesian coordinates it can be difficult to work with since every point on the (unit) circle takes the form <m>(x,\pm\sqrt{1-x^{2}})</m>. 
        This square root makes integrals and derivatives complicated. The main problem lies in the fact that we are trying to describe a circle using a rectangular coordinate system. 
        So our goal in this section is to find a more suitable coordinate system for circles.
      </p>
      <p>
        A circle can be described as the set of all points some fixed distance <m>r</m> from a given point, and we can specify any point on the circle by using an angle <m>\theta</m>:
      </p>
      <figure xml:id="figure-polar-coords">
        <image xml:id="image-polar-coords">
          <latex-image><![CDATA[
            \begin{tikzpicture}[scale=.6]

            % Draw circle.
            \draw[thick] (0,0) circle (3);

            % Mark points.
            \coordinate (A) at (48:3);
            \coordinate (B) at (0,0);
            \coordinate (C) at (3,0);

            \fill[blue] (A) circle [radius=2pt];
            \node at (A) [above right]{$P$};

            % Label radius and angle \( \theta \).
            \draw[decorate,decoration={brace,amplitude=5pt},xshift=-1pt,yshift=2pt] 
            (B) -- (A) node[midway, above,xshift=-5pt]{$r$};
            \draw (B) -- (A);
            \draw (B) -- (C);

            \path[clip] (A) -- (B) -- (C);
            \draw[fill=red!40] (B) circle (1);
            \node at ($ (B) + (27:.6) $) {$\theta$};
            \end{tikzpicture}]]>
          </latex-image>
        </image>
        <caption>Using distance and angle to specify a point.</caption>
      </figure>
      <p>
        Any point <m>P</m> on the circle can be described solely using the distance <m>r</m> and the direction <m>\theta</m>.
        This leads directly to the idea of polar coordinates. In polar coordinates, the <m>xy</m>-plane is replaced with an <m>r\theta</m>-plane, or <term>polar plane</term>.
        Each point in the polar plane has the form <m>(r,\theta)</m>, where the <term>radial coordinate</term> <m>r</m> denotes the distance from the origin, or <term> pole</term>, and the <term>angular coordinate</term> <m>\theta</m> determines the angle the point makes with the horizontal <term>polar axis</term>.
        The polar axis replaces the positive <m>x</m>-axis from Cartesian coordinates:
      </p>
      <figure xml:id="figure-polar-plane">
        <image xml:id="image-polar-plane">
          <latex-image><![CDATA[
            \begin{tikzpicture}[scale=.6]

            % Draw polar angles.
            \foreach \A in {0,30,...,360}
            \draw[thick, gray!40] (0,0) -- (\A:5.3);
            \foreach \B in {0,30,...,330}
            \draw (\B:5.8) node[black]{$\B^\circ$};

            \foreach \C in {45,135,225,315}
            \draw[thick,gray!40] (0,0) -- (\C:5.3);
            \foreach \D in {45,135,225,315}
            \draw (\D:5.8) node[black]{$\D^\circ$};

            % Draw polar cricles.
            \foreach \r in {1,2,...,5}
            \draw[thick, gray!40] (0,0) circle (\r);
            \foreach \s in {0,1,...,5}
            \draw (\s,0) node[below right]{$\s$};
            \foreach \s in {0,1,...,5}
            \fill[black] (\s,0) circle [radius=2pt];

            % Draw polar axis.
            \draw[thick,<->] (-5.3,0) -- (5.3,0);

            \end{tikzpicture}
            ]]>
          </latex-image>
        </image>
        <caption>The polar plane.</caption>
      </figure>
      <p>
        In polar coordinates, positive <m>\theta</m> correspond to counterclockwise direction, and negative <m>\theta</m> correspond to clockwise direction.
        We also allow for <m>r</m> to be negative: this just means go in the direction opposite of <m>\theta</m>.
      </p>
      <example xml:id="example-plotting-polar-coordinates">
        <title>Plotting polar coordinates</title>
        <p>
          Suppose we want to plot the points <m>(3,\pi), (-2,\frac{\pi}{4})</m> and <m>(2,\frac{5\pi}{4}).</m>
          We can do so in the polar plane by remembering that the first coordinate is distance from the pole, and the second coordinate is direction from the polar axis.
          If we plot these points, we see that <m>(-2,\frac{\pi}{4})</m> and <m>(2,\frac{5\pi}{4})</m> actually represent the same point. This is typical of polar coordinates: every point has, in general, infinitely many representations.
        </p>
      </example>
      <figure xml:id="figure-example-polar-coords">
        <image xml:id="image-example-polar-coords">
          <latex-image><![CDATA[
            \begin{tikzpicture}[scale=.6]

            % Draw polar angles.
            \foreach \A in {0,30,...,360}
            \draw[thick, gray!40] (0,0) -- (\A:5.3);
            \foreach \B in {0,30,...,330}
            \draw (\B:5.8) node[black]{$\B^\circ$};

            \foreach \C in {45,135,225,315}
            \draw[thick,gray!40] (0,0) -- (\C:5.3);
            \foreach \D in {45,135,225,315}
            \draw (\D:5.8) node[black]{$\D^\circ$};

            % Draw polar cricles.
            \foreach \r in {1,2,...,5}
            \draw[thick,gray!40] (0,0) circle (\r);
            \foreach \s in {0,1,...,5}
            \draw (\s,0) node[below right]{$\s$};
            \foreach \s in {0,1,...,5}
            \fill[black] (\s,0) circle [radius=2pt];

            % Draw polar axis.
            \draw[thick,<->] (-5.3,0) -- (5.3,0);

            % Plot points.
            \fill[blue] (180:3) circle [radius=3pt];
            \node at (180:3) [above left,fill=white,yshift=2pt]{\footnotesize $(3,\pi)$};

            \fill[blue] (45:-2) circle [radius=3pt];
            \node at (45:-2) [below,fill=white,yshift=-2pt]{\footnotesize $(-2,\pi/4),                      (2,5\pi/4)$};
            \end{tikzpicture}]]>
          </latex-image>
        </image>
        <caption>The plot from <xref ref="example-plotting-polar-coordinates" text="type-global" />.</caption>
      </figure>
    </subsection>

    <subsection xml:id="subsection-converting-coordinates">
      <title>Converting Coordinates</title>
      <p>
        If we want to use polar coordinates, then it'd be helpful to know how to convert between Cartesian (rectangular) coordinates and polar coordinates.
        The following diagram will help us to make these conversions.
      </p>
      <figure xml:id="figure-cartesian-to-polar">
        <image xml:id="image-cartesian-to-polar">
          <latex-image><![CDATA[
            \begin{tikzpicture}
            % Label axes.
            \draw[->] (0,-.5) -- (0,3) node[above]{$y$};
            \draw[->] (-.5,0) -- (3,0) node[right]{$x$}; 

            % Draw and label polar/rectangular.
            \draw[blue] (0,0) -- (2,2) node[midway,above,black]{$r$};
            \node at (2,2) [above right]{$P$};

            \draw[red,dashed] (2,2) -- (2,0) node[midway,right,black]{$y$};
            \draw (0,0) -- (2,0) node[midway,below]{$x$};

            % Denote right angle.
            \draw[red!40,thin] (1.7,0) -- (1.7,.3) -- (2,.3); 

            % Draw arc.
            \draw[red,->] (0:1) arc (0:45:1) node[below right,black,xshift=5pt]{$\theta$};

            % Label point $P$.
            \fill[black] (2,2) circle [radius=2pt];

            \end{tikzpicture}]]>
          </latex-image>
        </image>
        <caption>Converting between Cartesian and polar coordinates.</caption>
      </figure>
      <p>So in terms of <m>r,\theta</m>, we have</p>
      <md>
        <mrow>x \amp = r\cos\theta </mrow>
        <mrow>y \amp = r\sin\theta </mrow>
      </md>
      <p>
        Going in the other direction, the Pythagorean theorem tells us that <m>r = \sqrt{x^{2}+y^{2}}</m>, while <m>\tan\theta = \frac{y}{x}</m>.
      </p>
      <example xml:id="example-converting-polar-to-cartesian">
        <title>Converting polar to Cartesian</title>
        <p>Suppose we want to convert the point <m>(3,\frac{\pi}{3})</m> in polar coordinates to Cartesian coordinates <m>(x,y)</m>. Then we have</p>
        <md>
          <mrow>x \amp = 3\cos\frac{\pi}{3} </mrow>
          <mrow>y \amp = 3\sin\frac{\pi}{3} </mrow>
        </md>
        <p>and so the Cartesian point is <m>(\frac{3}{2},\frac{3\sqrt{3}}{2}).</m></p>
      </example>

      <example xml:id="example-converting-cartesian-to-polar">
        <title>Converting Cartesian to polar</title>
        <p>Suppose we now want to convert the point <m>(-\sqrt{3},1)</m> in Cartesian coordinates to polar coordinates. Then finding <m>r</m> is relatively straightforward: </p>
        <me>r = \sqrt{3+1} = 2.</me>
        <p>Finding <m>\theta</m> requires a bit more care. We know that <m>\theta</m> has to satisfy <m>\tan\theta = -\frac{1}{\sqrt{3}}</m>. One choice that makes this work is <m>\theta = -\frac{\pi}{6}</m>. However, this is incorrect! Whatever <m>\theta</m> is needs to be consistent with the fact that our point lies in the second quadrant. So we'll pick <m>\theta = \frac{5\pi}{6}</m> instead. Hence one way to write the point in polar coordinates is given by <m>(2,\frac{5\pi}{6}).</m></p>
      </example>

      <example xml:id="example-converting-equations">
        <title>Converting equations</title>
        <p>Consider the polar equation <m>r\cos\theta = 2\sin\theta\cos\theta</m>. We can convert this into a Cartesian equation using the above formulas. In particular, we use <m>r\cos\theta = x</m> and <m>r\sin\theta = y</m>. So <m>\cos\theta = \frac{x}{r}, \sin\theta = \frac{y}{r}</m> and the equation becomes</p>
        <me>x = \frac{2xy}{r^{2}} = \frac{2xy}{x^{2}+y^{2}}.</me>
      </example>
    </subsection>

    <subsection xml:id="subsection-polar-curves">
      <title>Polar Curves</title>
      <p>Now we move on to graphing polar equations.</p>
      <example xml:id="example-graphs-of-constants-in-polar-coordinates">
        <title>Graphs of constants in polar coordinates</title>
        <p>In Cartesian coordinates, the graphs of <m>x=a</m> and <m>y=a</m> give horizontal and vertical lines, respectively. In polar coordinates, the graphs of <m>r=a</m> and <m>\theta=a</m> have simple descriptions as well. The graph of <m>r=a</m> is just the set of all points <m>a</m> units away from the pole, so it's just a circle of radius <m>|a|</m> centered at the pole. Likewise, the graph of <m>\theta = a</m> is the set of all points that make an angle of <m>a</m> with the polar axis, so it's just a line through the pole.</p>
      </example>

      <example xml:id="example-graphs-from-cartesian-equations">
        <title>Graphs from Cartesian equations</title>
        <p>In some cases it's beneficial to convert a polar equation to a Cartesian equation. The Cartesian equation may have a recognizable form that helps us to identify the corresponding polar graph. For example, suppose we want to describe the graph of <m>r = 2a\sin\theta</m> for some constant <m>a</m>. Then we can convert it to a Cartesian equation, in particular</p>
        <me>x^{2}+y^{2} - 2ay = 0.</me>
        <p>If we complete the square, we get <m>x^{2}+(y-a)^{2} = a^{2}</m>, which describes a circle centered at <m>(0,a)</m> (in the <m>xy</m>-plane) and with radius <m>|a|</m>. In the polar plane, this is a circle of radius <m>|a|</m> centered at <m>(a,\frac{\pi}{2}).</m> Similarly, <m>r=2a\cos\theta</m> describes a circle of radius <m>|a|</m> centered at <m>(a,0)</m>.</p>
      </example>

      <example xml:id="example-another-circle">
        <title>Another circle</title>
        <p>Suppose we want to graph <m>r=-3\cos\theta</m>. From the previous example, we know that this will be a circle of radius <m>\frac{3}{2}</m> centered at <m>(-\frac{3}{2},0)</m>. See the following figure.</p>
      </example>
      <figure xml:id="figure-cosine-polar-circle">
        <image xml:id="image-cosine-polar-circle">
          <latex-image><![CDATA[
            \begin{tikzpicture}[scale=.5]
            % Draw polar angles.
            \foreach \A in {0,30,...,360}
            \draw[thick, gray!40] (0,0) -- (\A:5.3);
            \foreach \B in {0,30,...,330}
            \draw (\B:5.8) node[black]{$\B^\circ$};

            \foreach \C in {45,135,225,315}
            \draw[thick,gray!40] (0,0) -- (\C:5.3);
            \foreach \D in {45,135,225,315}
            \draw (\D:5.8) node[black]{$\D^\circ$};

            % Draw polar cricles.
            \foreach \r in {1,2,...,5}
            \draw[thick, gray!40] (0,0) circle (\r);
            \foreach \s in {0,1,...,5}
            \draw (\s,0) node[below right]{$\s$};
            \foreach \s in {0,1,...,5}
            \fill[black] (\s,0) circle [radius=2pt];

            % Draw polar axis.
            \draw[thick,<->] (-5.3,0) -- (5.3,0);

            % Draw $r=-3\cos\theta$.
            \draw[red] (-1.5,0) circle (1.5);
            \end{tikzpicture}]]>
          </latex-image>
        </image>
        <caption>The circle from <xref ref="example-another-circle" text="type-global" />.</caption>
      </figure>
    </subsection>

    <subsection xml:id="subsection-cartesian-to-polar-method">
      <title>Cartesian to Polar Method</title>
      <p>
        Graphing polar equations can be tricky, because it's easy to miss aspects of the graph unless you're careful.
        A useful method for graphing polar equations involves treating them as Cartesian equations first to get a better sense of how the graph behaves.
      </p>
      <example xml:id="example-three-leaf-rose">
        <title>Three leaf rose</title>
        <p>
          Suppose we want to graph <m>r = \cos3\theta</m>.
          We don't know what this looks like in the polar plane yet, but we have a pretty good idea of how it looks when treated as a Cartesian equation in the <m>r\theta</m>-plane (which we view as different from the polar plane!):
        </p>
        <figure xml:id="figure-cosine-cartesian">
          <image xml:id="image-cosine-cartesian">
            <latex-image><![CDATA[
              \begin{tikzpicture}[yscale=1.5]
              % Draw $theta$-axis points.
              \foreach \T in {0,.5*pi,pi,1.5*pi,2*pi}
              \fill[black] (\T,0) circle [radius=1.5pt];
              \node at (.5*pi,0) [black,below right]{$\frac{\pi}{2}$};
              \node at (pi,0) [black,below right]{$\pi$};
              \node at (1.5*pi,0) [black,below right]{$\frac{3\pi}{2}$};
              \node at (2*pi,0) [black,below right]{$2\pi$};

              % Draw $r$-axis points.
              \foreach \R in {-1,0,1}
              \fill[black] (0,\R) circle [radius=1.5pt];
              \foreach \R in {-1,0,1}
              \node at (0,\R) [black,left]{$\R$};

              % Draw $r$-axis.
              \draw[->] (0,-1.2) -- (0,1.2) node[black, above]{$r$};

              % Draw $\theta$-axis.
              \draw[->] (.05,0) -- (2.1*pi,0) node[black,above right]{$\theta$};

              % Plot graph of $r=\cos3\theta$.
              \draw[red,domain=0:1/3*pi,samples=100,smooth] plot (\x,{cos(3*\x r)});
              \node at (0,1) [black,above right]{$A$};
              \node at (1/3*pi,-1) [black,below]{$B$};
              \draw[blue,domain=1/3*pi:2/3*pi,samples=100,smooth] plot (\x,{cos(3*\x r)});
              \node at (2/3*pi,1) [black, above]{$C$};
              \draw[green,domain=2/3*pi:pi,samples=100,smooth] plot (\x,{cos(3*\x r)});
              \node at (pi,-1) [black,below]{$D$};
              \draw[yellow,domain=pi:4/3*pi,samples=100,smooth] plot (\x,{cos(3*\x r)});
              \node at (4/3*pi,1) [black,above]{$E$};
              \draw[purple,domain=4/3*pi:5/3*pi,samples=100,smooth] plot (\x,{cos(3*\x r)});
              \node at (5/3*pi,-1) [black,below]{$F$};
              \draw[orange,domain=5/3*pi:2*pi,samples=100,smooth] plot (\x,{cos(3*\x r)});
              \node at (2*pi,1) [black,above]{$G$};
              \end{tikzpicture}]]>
            </latex-image>
          </image>
          <caption>The graph of <m>r=\cos3\theta</m> as a Cartesian equation.</caption>
        </figure>
        <p>
          So we see that at <m>\theta</m> goes from <m>0</m> to <m>\frac{\pi}{3}</m>, <m>r</m> decreases from <m>1</m> to <m>-1</m>, hitting <m>0</m> along the way at <m>\theta=\frac{\pi}{6}</m>.
        </p>
        <figure xml:id="figure-cosine-cartesian-1">
          <image xml:id="image-cosine-cartesian-1">
            <latex-image><![CDATA[
              \begin{tikzpicture}
              % Draw polar angles.
              \foreach \A in {0,30,...,360}
              \draw[thick, gray!40] (0,0) -- (\A:2.3);
              \foreach \B in {0,30,...,330}
              \draw (\B:2.8) node[black]{$\B^\circ$};

              \foreach \C in {45,135,225,315}
              \draw[thick,gray!40] (0,0) -- (\C:2.3);
              \foreach \D in {45,135,225,315}
              \draw (\D:2.8) node[black]{$\D^\circ$};

              % Draw polar cricles.
              \foreach \r in {1,2}
              \draw[thick, gray!40] (0,0) circle (\r);
              \foreach \s in {0,1,2}
              \draw (\s,0) node[below right]{$\s$};
              \foreach \s in {0,1,2}
              \fill[black] (\s,0) circle [radius=2pt];

              % Draw polar axis.
              \draw[thick,<->] (-2.3,0) -- (2.3,0);

              % Polar plot from $A$ to $B$.
              \draw[color=red,domain=0:1/3*pi,samples=200,smooth] plot (xy polar
              cs:angle=\x r,radius=      {cos(3*\x r)});
              \fill[black] (0:1) circle [radius=2pt];
              \node at (0:1) [black,above right]{$A$};
              \fill[black] (1/3*pi r: -1) circle [radius=2pt];
              \node at (1/3*pi r:-1) [black,below]{$B$};
              \end{tikzpicture}]]>
            </latex-image>
          </image>
          <caption><m>\theta = 0</m> to <m>\theta = \frac{\pi}{3}</m>.</caption>
        </figure>
        <p>
          Now, as <m>\theta</m> goes from <m>\frac{\pi}{3}</m> to <m>\frac{2\pi}{3}</m> <m>r</m> will go from <m>-1</m> to <m>1</m>, hitting <m>0</m> at <m>\theta = \frac{\pi}{2}</m>:
        </p>
        <figure xml:id="figure-cosine-cartesian-2">
          <image xml:id="image-cosine-cartesian-2">
            <latex-image><![CDATA[
              \begin{tikzpicture}
              % Draw polar angles.
              \foreach \A in {0,30,...,360}
              \draw[thick, gray!40] (0,0) -- (\A:2.3);
              \foreach \B in {0,30,...,330}
              \draw (\B:2.8) node[black]{$\B^\circ$};

              \foreach \C in {45,135,225,315}
              \draw[thick,gray!40] (0,0) -- (\C:2.3);
              \foreach \D in {45,135,225,315}
              \draw (\D:2.8) node[black]{$\D^\circ$};

              % Draw polar cricles.
              \foreach \r in {1,2}
              \draw[thick, gray!40] (0,0) circle (\r);
              \foreach \s in {0,1,2}
              \draw (\s,0) node[below right]{$\s$};
              \foreach \s in {0,1,2}
              \fill[black] (\s,0) circle [radius=2pt];

              % Draw polar axis.
              \draw[thick,<->] (-2.3,0) -- (2.3,0);

              % Polar plot from $A$ to $B$.
              \draw[color=red,domain=0:1/3*pi,samples=200,smooth] plot (xy polar
              cs:angle=\x r,radius=      {cos(3*\x r)});
              \fill[black] (0:1) circle [radius=2pt];
              \node at (0:1) [black,above right]{$A$};
              \fill[black] (1/3*pi r: -1) circle [radius=2pt];
              \node at (1/3*pi r:-1) [black,below]{$B$};

              % Polar plot from $B$ to $C$.
              \draw[color=blue,domain=1/3*pi:2/3*pi,samples=200,smooth] plot (xy polar
              cs:angle=\x r,radius=      {cos(3*\x r)});
              \fill[black] (2/3*pi r: 1) circle [radius=2pt];
              \node at (2/3*pi r:1) [black,above right]{$C$};
              \end{tikzpicture}]]>
            </latex-image>
          </image>
          <caption><m>\theta = \frac{\pi}{3}</m> to <m>\theta = \frac{2\pi}{3}</m>.</caption>
        </figure>
        <p>
          Continuing in this manner lets us complete the graph:
        </p>
        <figure xml:id="figure-cosine-cartesian-3">
          <image xml:id="image-cosine-cartesian-3">
            <latex-image><![CDATA[
              \begin{tikzpicture}
              % Draw polar angles.
              \foreach \A in {0,30,...,360}
              \draw[thick, gray!40] (0,0) -- (\A:2.3);
              \foreach \B in {0,30,...,330}
              \draw (\B:2.8) node[black]{$\B^\circ$};

              \foreach \C in {45,135,225,315}
              \draw[thick,gray!40] (0,0) -- (\C:2.3);
              \foreach \D in {45,135,225,315}
              \draw (\D:2.8) node[black]{$\D^\circ$};

              % Draw polar cricles.
              \foreach \r in {1,2}
              \draw[thick, gray!40] (0,0) circle (\r);
              \foreach \s in {0,1,2}
              \draw (\s,0) node[below right]{$\s$};
              \foreach \s in {0,1,2}
              \fill[black] (\s,0) circle [radius=2pt];

              % Draw polar axis.
              \draw[thick,<->] (-2.3,0) -- (2.3,0);

              % Polar plot from $A$ to $B$.
              \draw[thick,color=red,domain=0:1/3*pi,samples=200,smooth] plot (xy polar
              cs:angle=\x r,radius=      {cos(3*\x r)});
              \fill[black] (0:1) circle [radius=2pt];
              \node at (0:1) [black,above right]{$A,D$};
              \fill[black] (1/3*pi r: -1) circle [radius=2pt];
              \node at (1/3*pi r:-1) [black,below]{$B$};

              % Polar plot from $B$ to $C$.
              \draw[thick,color=blue,domain=1/3*pi:2/3*pi,samples=200,smooth] plot (xy polar
              cs:angle=\x r,radius=      {cos(3*\x r)});
              \fill[black] (2/3*pi r: 1) circle [radius=2pt];
              \node at (2/3*pi r:1) [black,above right]{$C$};

              % Polar plot from $C$ to $D$.
              \draw[thick,color=green,domain=2/3*pi:pi,samples=200,smooth] plot (xy polar
              cs:angle=\x r,radius=      {cos(3*\x r)});
              \end{tikzpicture}]]>
            </latex-image>
          </image>
          <caption>The graph of <m>r=\cos3\theta</m> in the polar plane.</caption>
        </figure>
      </example>
      <p>
        SUGGESTED PROBLEMS: 1, 3, 11, 23, 37
      </p>
    </subsection>
  </section>
  <section xml:id="section-calculus-and-polar-coordinates">
    <title>Calculus and Polar Coordinates</title>
    <subsection xml:id="subsection-areas-of-polar-curves">
      <title>Areas of Polar Curves</title>
      <p>
        To find the area of a region swept out by a polar curve, we need to reinvent the integral so to speak.
        In Cartesian coordinates, the integral was based on using rectangles to approximate areas. For polar coordinates, it makes more sense to use circular sectors.
      </p>
      <p>
        Consider a region <m>R</m> bounded by the polar curve <m>r = f(\theta)</m>:
      </p>
      <figure xml:id="figure-polar-region">
        <image xml:id="image-polar-region">
          <latex-image><![CDATA[
            \begin{tikzpicture}[scale=1.5]

            \draw[thick,->] (0,0) -- (5,0);     
            \draw[thick,->] (0,0) -- (0,4);     

            % plot points
            \coordinate (A) at (84:3);

            \coordinate (B) at (64:3);

            \coordinate (C) at (44:3.5);

            \coordinate (D) at (24:3.6);

            \coordinate (E) at (4:4);

            \begin{scope}

            % connect points & shade
            \draw
            [preaction={fill,blue!15,opacity=.5}]       
            [black,thick] plot [smooth] coordinates {(A)(B)(C)(D)(E)};
            \path[clip] (A) -- (0,0) -- (E);
            \fill[opacity=.5,blue!15] (0,0) circle (5);

            \end{scope}

            % Draw angles.
            \draw[thick,red] (0,0) -- (84:3.2) node[above,black]{$\theta=\beta$};
            \draw[thick,red] (0,0) -- (64:3.2);
            \draw[thick,red] (0,0) -- (44:3.7) node[black,midway,yshift=.5cm]{$R$};
            \draw[thick,red] (0,0) -- (24:3.8);
            \draw[thick,red] (0,0) -- (4:4.2) node[above right,black]{$\theta=\alpha$};

            % Label $f(\theta)$
            \node at (4,2) [black]{$f(\theta)$};
            \end{tikzpicture}]]>
          </latex-image>
        </image>
        <caption>The polar region <m>r = f(\theta)</m>.</caption>
      </figure>
      <p>
        To find the area of this region, we'll approximate it using circular sectors.
        Since we want to find the area between <m>\theta=\alpha</m> and <m>\theta=\beta</m>, we'll break the interval <m>[\alpha,\beta]</m> into <m>n</m> subintervals <m>[\theta_{i},\theta_{i+1}]</m> of equal length <m>\Delta\theta</m>, with
      </p>
      <me>\alpha = \theta_{0} &lt; \theta_{1} &lt; \dots &lt; \theta_{n} = \beta.</me>
      <figure xml:id="figure-polar-region-1">
        <image xml:id="image-polar-region-1">
          <latex-image><![CDATA[
            \begin{tikzpicture}[scale=1.5]

            \draw[thick,->] (0,0) -- (5,0);     
            \draw[thick,->] (0,0) -- (0,4);     

            % plot points
            \coordinate (A) at (84:3);

            \coordinate (B) at (64:3);

            \coordinate (C) at (44:3.5);

            \coordinate (D) at (24:3.6);

            \coordinate (E) at (4:4);

            \begin{scope}

            % connect points & shade
            \draw
            [preaction={fill,blue!15,opacity=.5}]       
            [black,thick] plot [smooth] coordinates {(A)(B)(C)(D)(E)};
            \path[clip] (A) -- (0,0) -- (E);
            \fill[opacity=.5,blue!15] (0,0) circle (5);

            \end{scope}

            % draw slices.
            \begin{scope}
            \path[clip] ($(A)+(84:1) $) -- (0,0) -- ($(B)+(64:1)$);
            \draw[thick,red] (0,0) circle (3);
            \end{scope}

            \begin{scope}
            \path[clip] ($(B)+(64:1) $) -- (0,0) -- ($(C)+(44:1)$);
            \draw[thick,red] (0,0) circle (3);
            \end{scope} 

            \begin{scope}
            \path[clip] ($(C)+(44:1) $) -- (0,0) -- ($(D)+(24:1)$);
            \draw[thick,red] (0,0) circle (3.5);
            \end{scope} 

            \begin{scope}
            \path[clip] ($(D)+(24:1) $) -- (0,0) -- ($(E)+(4:1)$);
            \draw[thick,red] (0,0) circle (3.6);
            \end{scope} 

            % Draw angles.
            \draw[thick,red] (0,0) -- (84:3.2) node[above,black]{$\theta=\beta$};
            \draw[thick,red] (0,0) -- (64:3.2);
            \draw[thick,red] (0,0) -- (44:3.7) node[black,midway,yshift=.5cm]{$R$};
            \draw[thick,red] (0,0) -- (24:3.8);
            \draw[thick,red] (0,0) -- (4:4.2) node[above right,black]{$\theta=\alpha$};

            % Draw line indicating $f(\theta_k)$
            \draw[red,dashed] (0,0) -- (34:3.5) node[black,above right]{$f(\theta_k)$};

            % Label $f(\theta)$
            \node at (5,1) [black]{$f(\theta)$};
            \end{tikzpicture}]]>
          </latex-image>
        </image>
        <caption>Approximating the region with circular sectors.</caption>
      </figure>
      <p>The area of each slice is given by</p>
      <me>\frac{\text{angle swept out by slice}}{2}(\text{radius})^{2}.</me>
      <p>For one of our slices, this takes the form</p>
      <me>\frac{\Delta\theta}{2}f(\theta_{i})^{2}.</me>
      <p>Adding these areas up gives us the approximate area of the region. So we can say that</p>
      <me>\text{area of }R \approx \sum_{i=0}^{n}\frac{1}{2}f(\theta_{i})^{2}\Delta\theta.</me>
      <p>As <m>\Delta\theta</m> gets smaller, this approximation should become exact. So we can say</p>
      <me>\text{area of }R = \lim_{\Delta\theta\to0}\sum_{i=0}^{n}\frac{1}{2}f(\theta_{i})^{2}\Delta\theta.</me>
      <p>This limit is exactly the definition of an integral! So we have</p>
      <me>\text{area of }R = \int_{\alpha}^{\beta}\frac{1}{2}f(\theta)^{2}\,d\theta.</me>
      <p>We can summarize this in the following theorem.</p>
      <theorem xml:id="theorem-area-in-polar-coordinates">
        <title>Area in Polar Coordinates</title>
        <idx><h>polar coordinates</h><h>area</h></idx>
        <statement>
          <p>Suppose that <m>R</m> is a region bounded by the polar curves <m>r=f(\theta)</m> and <m>r=g(\theta)</m> between <m>\theta = \alpha</m> and <m>\theta=\beta</m>. If <m>f</m> and <m>g</m> are continuous and <m>f(\theta)\geq g(\theta)</m> for <m>\alpha\leq\theta\leq\beta,</m> then the area of <m>R</m> is given by
          <me>\int_{\alpha}^{\beta}\frac{1}{2}[f(\theta)^{2}-g(\theta)^{2}]\,d\theta.</me></p>
        </statement>
      </theorem>

      <example xml:id="example-area-bounded-by-a-cardioid">
        <title>Area bounded by a cardioid</title>
        <p>Consider the cardioid<fn>The name will become clearer once we graph this.</fn> <m>r = 4+4\cos\theta</m>. The area is given by</p>
        <me>\int_{\alpha}^{\beta}\frac{1}{2}(4+4\cos\theta)^{2}\,d\theta = \int_{\alpha}^{\beta}8(1+2\cos\theta+\cos^{2}\theta)\,d\theta</me>
        <p>To find this, we'll need to figure out the limits of integration. For polar plots, the best way to do this is by graphing. We'll graph <m>r=4+4\cos\theta</m> by using the Cartesian to polar methods described in <xref ref="subsection-cartesian-to-polar-method" text="title" />. First, we treat this as a Cartesian curve in the <m>r\theta</m>-plane and graph it to get</p>
        <figure xml:id="figure-cardioid">
          <image xml:id="image-cardioid">
            <latex-image><![CDATA[
              \begin{tikzpicture}[scale=.6]

              % Draw $theta$-axis points.
              \foreach \T in {0,.5*pi,pi,1.5*pi,2*pi}
              \fill[black] (\T,0) circle [radius=1.5pt];
              \node at (.5*pi,0) [black,below right]{$\frac{\pi}{2}$};
              \node at (pi,0) [black,below right]{$\pi$};
              \node at (1.5*pi,0) [black,below right]{$\frac{3\pi}{2}$};
              \node at (2*pi,0) [black,below right]{$2\pi$};

              % Draw $r$-axis points.
              \foreach \R in {0,1,...,8}
              \fill[black] (0,\R) circle [radius=1.5pt];
              \foreach \R in {0,1,...,8}
              \node at (0,\R) [black,left]{$\R$};

              % Draw $r$-axis.
              \draw[->] (0,0.2) -- (0,8.2) node[black, above]{$r$};

              % Draw $\theta$-axis.
              \draw[->] (.05,0) -- (2.1*pi,0) node[black,above right]{$\theta$};

              % Plot graph of $r=4+4*\cos\theta$.
              \draw[red,domain=0:2*pi,samples=100,smooth,thick] plot (\x, {4+4*cos(\x r)});   

              \end{tikzpicture}]]>
            </latex-image>
          </image>
          <caption><m>r = 4 + 4\cos\theta</m> as a Cartesian equation.</caption>
        </figure>
        <p>Now we can plot the corresponding polar curve:</p>
        <figure xml:id="figure-cardioid-1">
          <image xml:id="image-cardioid-1">
            <latex-image><![CDATA[
              \begin{tikzpicture}[scale=.6]

              % Draw polar angles.
              \foreach \A in {0,30,...,360}
              \draw[thick, gray!40] (0,0) -- (\A:8.3);
              \foreach \B in {0,30,...,330}
              \draw (\B:8.8) node[black]{$\B^\circ$};

              \foreach \C in {45,135,225,315}
              \draw[thick,gray!40] (0,0) -- (\C:8.3);
              \foreach \D in {45,135,225,315}
              \draw (\D:8.8) node[black]{$\D^\circ$};

              % Draw polar cricles.
              \foreach \r in {1,2,...,8}
              \draw[thick,gray!90]  (0,0) circle (\r);
              \foreach \s in {0,1,...,8}
              \draw (\s,0) node[below right]{$\s$};
              \foreach \s in {0,1,...,8}
              \fill[black] (\s,0) circle [radius=2pt];

              % Draw polar axis.
              \draw[thick,<->] (-8.3,0) -- (8.3,0);

              % Polar plot of $4+4*\cos\theta$.
              \draw[thick,color=red,domain=0:2*pi,samples=200,smooth] plot (xy polar
              cs:angle=\x r,radius= {4+4*cos(\x r)});
              \end{tikzpicture}]]>
            </latex-image>
          </image>
          <caption><m>r = 4 + 4\cos\theta</m> as a polar equation.</caption>
        </figure>
        <p>The important thing to notice is that we trace out the curve exactly once as <m>\theta</m> goes from <m>0</m> to <m>2\pi</m>, so our limits should be <m>0</m> and <m>2\pi</m>. Hence the area of this region is given by</p>
        <md>
          <mrow>\int_{0}^{2\pi}8(1+2\cos\theta+\cos^{2}\theta)\,d\theta \amp = 8\theta\Big]_{0}^{2\pi} + 16\sin\theta\Big]_{0}^{2\pi} + 4\int_{0}^{2\pi}(1+\cos2\theta)\,d\theta </mrow>
          <mrow> \amp = 16\pi + 8\pi </mrow>
          <mrow> \amp = 24\pi. </mrow>
        </md>
      </example>

      <example xml:id="example-area-inside-a-rose-and-outside-a-circle">
        <title>Area inside a rose and outside a circle</title>
        <p>As another example of the use of <xref ref="theorem-area-in-polar-coordinates" text="type-global" />, we'll find the area of the region contained by the polar curves <m>r = 4\cos2\theta</m> and outside the circle <m>r=2</m>. Again, a great way to start this problem is to graph the region under consideration.</p>
        <figure xml:id="figure-rose-circle">
          <image xml:id="image-rose-circle">
            <latex-image><![CDATA[
              \begin{tikzpicture}[scale=.5]

              % Shades regions.
              \foreach \n in {0,1/2*pi,pi,3/2*pi}
              \draw [fill=blue!60!red,fill opacity=0.3] plot                                                              [smooth,samples=100,domain=-1/6*pi+\n:1/6*pi+\n]
              (xy polar cs:angle=\x r, radius={4*cos(2*\x r)}) -- plot                                                        [smooth,samples=100,domain=-1/6*pi+\n:1/6*pi+\n] 
              (xy polar cs:angle=\x r,radius={2});

              % Prevents overshading.
              \fill[white] (0,0) circle (2);

              % Draw polar angles.
              \foreach \A in {0,30,...,360}
              \draw[thick, gray!40] (0,0) -- (\A:4.3);
              \foreach \B in {0,30,...,330}
              \draw (\B:4.8) node[black]{$\B^\circ$};

              \foreach \C in {45,135,225,315}
              \draw[thick,gray!40] (0,0) -- (\C:4.3);
              \foreach \D in {45,135,225,315} 
              \draw (\D:4.8) node[black]{$\D^\circ$};

              % Draw polar cricles.
              \foreach \r in {1,2,...,4}
              \draw[thick,gray!90]  (0,0) circle (\r);
              \foreach \s in {0,1,...,4}
              \draw (\s,0) node[below right]{$\s$};
              \foreach \s in {0,1,...,4}
              \fill[black] (\s,0) circle [radius=2pt];

              % Draw polar axis.
              \draw[thick,<->] (-4.3,0) -- (4.3,0);

              % Polar plot of $4*\cos2*\theta$.
              \draw[thick,color=red,domain=0:2*pi,samples=200,smooth] plot (xy polar
              cs:angle=\x r,radius= {4*cos(2*\x r)});

              \draw[thick,red] (0,0) circle (2);

              \end{tikzpicture}]]>
            </latex-image>
          </image>
          <caption>Region contained between polar curves.</caption>
        </figure>
        <p>With a little bit of work, we can see that the area of one of these shaded regions is given by</p>
        <me>\int_{-\frac{\pi}{6}}^{\frac{\pi}{6}} \frac{1}{2}[(4\cos2\theta)^{2}-4]\,d\theta</me>
        <p>and so the area of the entire region is</p>
        <me>2\int_{-\frac{\pi}{6}}^{\frac{\pi}{6}}[(4\cos2\theta)^{2}-4]\,d\theta.</me>
      </example>
    </subsection>
    <subsection xml:id="subsection-arc-length-in-polar-coordinates">
      <title>Arc Length in Polar Coordinates</title>
      <p>Our goal now is to find the length of a polar curve <m>r=f(\theta)</m>. From <xref ref="subsection-arc-length-parametric-curves" text="title" /> we know how to find the length of a parametric curve, and a polar curve is really just a parametric curve with parametric equations</p>
      <me>x = r\cos\theta = f(\theta)\cos\theta \quad\text{and}\quad y = r\sin\theta = f(\theta)\sin\theta.</me>
      <p>Using the formula <m>L = \int_{a}^{b}\sqrt{(\dv{x}{\theta})^{2}+(\dv{y}{\theta})^{2}}\,d\theta</m> and simplifying, we get the following result.</p>
      <theorem xml:id="theorem-arc-length-of-a-polar-curve">
        <title>Arc Length of a Polar Curve</title>
        <idx><h>polar coordinates</h><h>arc length</h></idx>
        <statement>
          <p>The length <m>L</m> of a polar curve <m>r = f(\theta)</m> from <m>\theta=a</m> to <m>\theta=b</m> is given by
          <me>L = \int_{a}^{b}\sqrt{r^{2} + \left(\dv{r}{\theta}\right)^{2}}\,d\theta.</me></p>
        </statement>
      </theorem>

      <example xml:id="example-arc-length-of-a-leaf">
        <title>Arc length of a leaf</title>
        <p>Let <m>r = \cos2\theta</m>. Then this gives a four-leaf rose in the polar plane. We want to find the length of one leaf of this rose. As usual, it's a good idea to graph this curve first.</p>
        <figure xml:id="figure-rose">
          <image xml:id="image-rose">
            <latex-image><![CDATA[
              \begin{tikzpicture}[scale=.5]
              % Prevents overshading.
              \fill[white] (0,0) circle (2);

              % Draw polar angles.
              \foreach \A in {0,30,...,360}
              \draw[thick, gray!40] (0,0) -- (\A:4.3);
              \foreach \B in {0,30,...,330}
              \draw (\B:4.8) node[black]{$\B^\circ$};

              \foreach \C in {45,135,225,315}
              \draw[thick,gray!40] (0,0) -- (\C:4.3);
              \foreach \D in {45,135,225,315} 
              \draw (\D:4.8) node[black]{$\D^\circ$};

              % Draw polar cricles.
              \foreach \r in {1,2,...,4}
              \draw[thick,gray!90]  (0,0) circle (\r);
              \foreach \s in {0,1,...,4}
              \draw (\s,0) node[below right]{$\s$};
              \foreach \s in {0,1,...,4}
              \fill[black] (\s,0) circle [radius=2pt];

              % Draw polar axis.
              \draw[thick,<->] (-4.3,0) -- (4.3,0);

              % Polar plot of $\cos2*\theta$.
              \draw[thick,color=red,domain=0:2*pi,samples=200,smooth] plot (xy polar
              cs:angle=\x r,radius= {cos(2*\x r)});
              \end{tikzpicture}]]>
            </latex-image>
          </image>
          <caption>The four leaf rose <m>r=\cos2\theta</m>.</caption>
        </figure>
        <p>
          One leaf of the rose should be captured as <m>\theta</m> varies from <m>-\frac{\pi}{4}</m> to <m>\frac{\pi}{4}</m>, so using <xref ref="theorem-arc-length-of-a-polar-curve" text="type-global" /> we can find the length of this leaf:
        </p>
        <me>L = \int_{-\frac{\pi}{4}}^{\frac{\pi}{4}}\sqrt{\cos^{2}2\theta + 4\sin^{2}2\theta}\,d\theta = \int_{-\frac{\pi}{4}}^{\frac{\pi}{4}}\sqrt{1 + 3\sin^{2}2\theta}\,d\theta.</me>
      </example>
      <p>
        SUGGESTED PROBLEMS: 1, 3, 7, 9, 15, 19, 35
      </p>
    </subsection>
  </section>
  <!-- I'm keeping these here for now in case I need to see how this is done later. -->
<!--     <xi:include href="./sage/integers-sage.xml" />
<xi:include href="./sage/integers-sage-exercises.xml" /> -->

</chapter>
